<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>User Profile Page - Ace Admin</title>

		<meta name="description" content="3 styles with inline editable feature" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<!-- basic styles -->

		<link href="assets2/css/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="assets2/css/font-awesome.min.css" />

		<!--[if IE 7]>
		  <link rel="stylesheet" href="assets2/css/font-awesome-ie7.min.css" />
		<![endif]-->

		<!-- page specific plugin styles -->

		<link rel="stylesheet" href="assets2/css/jquery-ui-1.10.3.custom.min.css" />
		<link rel="stylesheet" href="assets2/css/jquery.gritter.css" />
		<link rel="stylesheet" href="assets2/css/select2.css" />
		<link rel="stylesheet" href="assets2/css/bootstrap-editable.css" />
		
		<script src="js/jquery-3.2.1.min.js"></script>
    	<link href="css/font-awesome.min.css" rel="stylesheet" type="text/css" media="all" /> 
  		<link href="assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  		<link rel="stylesheet" href="css/bootstrap-table.css" />
  		<link href="js/advanced-datatable/css/demo_page.css" rel="stylesheet" />
  		<link href="js/advanced-datatable/css/demo_table.css" rel="stylesheet" />
 		<link rel="stylesheet" href="js/data-tables/DT_bootstrap.css" /> 
		<script type="text/javascript" src="js/jquery-1.10.2.min.js"></script>
		<script type="text/javascript" src="js/browser.js"></script>
		<script type="text/javascript" src="js/bootstrap.min.js"></script>
		<script type="text/javascript" src="js/fileinput.js"></script>
		<script type="text/javascript" src="js/fileinput_locale_zh.js"></script>
		<script src="js/jquery.form.js" type="text/javascript"></script>
		<script src="js/fileload.js" type="text/javascript"></script>
		<script type="text/javascript" src="js/bootstrap-fileupload.js"></script>	
		<link rel="stylesheet" href="css/bootstrap.min.css"	type="text/css">
		<link rel="stylesheet" href="css/fileinput.css"	type="text/css">
		<!-- fonts -->

		

		<!-- ace styles -->

		<link rel="stylesheet" href="assets2/css/ace.min.css" />
		<link rel="stylesheet" href="assets2/css/ace-rtl.min.css" />
		<link rel="stylesheet" href="assets2/css/ace-skins.min.css" />
		<link rel="stylesheet" href="css/button.css">

		<!--[if lte IE 8]>
		  <link rel="stylesheet" href="assets2/css/ace-ie.min.css" />
		<![endif]-->

		<!-- inline styles related to this page -->

		<!-- ace settings handler -->

		<script src="assets2/js/ace-extra.min.js"></script>

		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->

		<!--[if lt IE 9]>
		<script src="assets2/js/html5shiv.js"></script>
		<script src="assets2/js/respond.min.js"></script>
		<![endif]-->
	</head>

	<body>
	<button id = "goBack"  class="button button-large button-plain button-border button-circle" style= "background: #229ffd; position: relative; left: 10px" ><i class="fa fa-reply"></i></button>
	

					<div class="page-content">
						

						

								<div class="hr dotted"></div>

								

								<div >
									<div id="user-profile-2" class="user-profile">
										<div class="tabbable">
											<ul class="nav nav-tabs padding-18">
												<li class="active">
													<a data-toggle="tab" href="#home">
														<i class="green icon-user bigger-120"></i>
														个人页面
													</a>
												</li>

												
											</ul>

											<div class="tab-content no-border padding-24">
												<div id="home" class="tab-pane in active">
													<div class="row">
														<div class="col-xs-12 col-sm-3 center">
															<span class="profile-picture">
																<a href="#"><img class="editable img-responsive" alt="Alex's Avatar" id="userImg"  style = "height:300px;width:300px;" /></a>
															</span>

															<div class="space space-4"></div>

															<a href="http://localhost:8088/ssf/modification.html" class="btn btn-sm btn-block btn-success" id = "goModify">
																
																<span class="bigger-110">更改资料</span>
															</a>

															<a href="#" class="btn btn-sm btn-block btn-primary" id = "logOut">
																
																<span class="bigger-110">退出用户</span>
															</a>
														</div><!-- /span -->

														<div class="col-xs-12 col-sm-9">
															<h4 class="blue">
																<span class="middle" id = "userName">Alex M. Doe</span>

																<span class="label label-purple arrowed-in-right">
																	<i class="icon-circle smaller-80 align-middle"></i>
																	online
																</span>
															</h4>

															<div class="profile-user-info">
																<div class="profile-info-row">
																	<div class="profile-info-name" > ID </div>

																	<div class="profile-info-value">
																		<span id= "userId">alexdoe</span>
																	</div>
																</div>
																
																<div class="profile-info-row">
																	<div class="profile-info-name"> 性别 </div>

																	<div class="profile-info-value">
																		<span id = "gender">未填写</span>
																	</div>
																</div>

																<div class="profile-info-row">
																	<div class="profile-info-name"> 位置 </div>

																	<div class="profile-info-value">
																		<i class="icon-map-marker light-orange bigger-110"></i>
																		<span id = "location">暂未填写</span>
																		
																	</div>
																</div>

																<div class="profile-info-row">
																	<div class="profile-info-name"> 出生日期 </div>

																	<div class="profile-info-value">
																		<span id = "birthday">暂未填写</span>
																	</div>
																</div>


																<div class="profile-info-row">
																	<div class="profile-info-name"> 资产 </div>

																	<div class="profile-info-value">
																		<span id = "asset">未知</span>
																	</div>
																</div>
																
																<div class="profile-info-row">
																	<div class="profile-info-name"> 邮箱 </div>

																	<div class="profile-info-value">
																		<span id = "email">未填写</span>
																	</div>
																</div>
																
																<div class="profile-info-row">
																	<div class="profile-info-name"> 持有股票数 </div>

																	<div class="profile-info-value">
																		<span id= "numberOfHold1">未知</span>
																	</div>
																</div>
																
															</div>

															<div class="hr hr-8 dotted"></div>

															<div class="profile-user-info">
												
																<div class="profile-info-row">
																	<div class="profile-info-name">
																		<img src="images/wechat.jpg" style = "width:30px;length:30px; position: relative; top:-5px"></img>
																	</div>

																	<div class="profile-info-value">
																		<span id = "qq">暂未填写</span>
																	</div>
																</div>

																<div class="profile-info-row">
																	<div class="profile-info-name">
																		<img src="images/qq.jpg" style = "width:30px;length:30px; position: relative; top:-5px"></img>
																	</div>

																	<div class="profile-info-value">
																		<span id = "wechat">暂未填写</span>
																	</div>
																</div>
															</div>
														</div><!-- /span -->
													</div><!-- /row-fluid -->

													<div class="space-20"></div>

													<div class="row">
														

														<div class="col-xs-12 col-sm-6" style = "width:100%">
															<div class="widget-box transparent">
																<div class="widget-header widget-header-small header-color-blue2">
																	<h4 class="smaller">
																		<i class="icon-lightbulb bigger-120"></i>
																		我的资产
																	</h4>
																</div>

																<div class="widget-body">
																	<div class="widget-main padding-16">
																		<div class="clearfix">
																			<div class="grid3 center">
																				<div class="easy-pie-chart percentage" data-percent="100" data-color="#CA5952">
																					<span class="percent" id = "totalAssets">45</span>元
																				</div>

																				<div class="space-2"></div>
																				总资产
																			</div>

																			<div class="grid3 center">
																				<div class="center easy-pie-chart percentage" data-percent="100" data-color="#59A84B">
																					<span class="percent" id = "numberOfHold">0</span>
																				</div>

																				<div class="space-2"></div>
																				持有股数量
																			</div>

																			<div class="grid3 center">
																				<div class="center easy-pie-chart percentage" data-percent="100" data-color="#9585BF">
																					<span id = "numberOfSubscribe">0</span>
																				</div>

																				<div class="space-2" ></div>
																				自选股数量
																			</div>
																		</div>

																		<div class="hr hr-16"></div>

																		
																	</div>
																</div>
															</div>
														</div>
													</div>
												</div><!-- #home -->

												

												

												
											</div>
										</div>
									</div>
								</div>

								<div >
									<div id="user-profile-3" class="user-profile row">
										<div class="col-sm-offset-1 col-sm-10">
											

											
									</div><!-- /user-profile -->
								</div>

								<!-- PAGE CONTENT ENDS -->
							</div><!-- /.col -->
						</div><!-- /.row -->
					</div><!-- /.page-content -->
				</div><!-- /.main-content -->

				

					
				</div><!-- /#ace-settings-container -->
			</div><!-- /.main-container-inner -->

			<a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
				<i class="icon-double-angle-up icon-only bigger-110"></i>
			</a>
		</div><!-- /.main-container -->
      <a class="button button-glow button-rounded button-royal" style = "position:relative; left:800px; top:8px">用户自选股</a>

<div class="panel-body" >
        <div class="adv-table" >
        <table  
		id="dynamic-table1"
		  data-url="usert/searchMySubscribe.action"  
       data-page-list="[5, 10, 15]"
       data-toggle="table"
       data-striped="true"
       
        >
        <thead>
        <!-- {"name":"peter","id":1,"pwd":"122"} -->
        <tr>
            <th data-field="sid">股票号</th>
            <th data-field="sname">股票名</th>
            <th data-field="openTod">今日最高价</th>
             <th data-field="closeYes">昨日收盘价</th>
             <th data-field="volume">成交数量</th>
             <th data-field="turnover">成交金额</th>
            <th data-field="edit1" class="hidden-phone">详细信息 </th>
            <th data-field="edit2" class="hidden-phone">已关注</th>
        </tr>
        </thead>
       
        </table>
        </div>
        </div>
<a class="button button-glow button-rounded button-royal" style = "position:relative; left:800px; top:4px">用户持有股</a>
<div class="panel-body"  style = >
        <div class="adv-table" >
        <table  
		id="dynamic-table2"
		    
       data-page-list="[5, 10, 15]"
       data-toggle="table"
       data-striped="true"
       
        >
        <thead>
        <!-- {"name":"peter","id":1,"pwd":"122"} -->
        <tr>
            <th data-field="sid">股票号</th>
            <th data-field="sname">股票名</th>
            <th data-field="hvolume">持有数</th> 
            <th data-field="edit1" class="hidden-phone">交易 </th>
            
        </tr>
        </thead>
       
        </table>
        </div>
        
        </div>
        <form class="stdform" id="formFile"  method="post" enctype="multipart/form-data">
        <input type="file" name="file" id="chooseFile" style= "visibility:hidden;" onchange = "changeIt()"/>
        </form>
        
         <ul class="breadcrumb" style = "position:absolute; left:80px; top:15px;background-color:rgba(0,0,0,0)">
							<li>
								<a href="http://localhost:8088/ssf/index.html" style = "font-size:20px">首页</a>
							</li>
							<li  style = "font-size:20px"> 个人中心</li>
						</ul>
		<!-- basic scripts -->

		<!--[if !IE]> -->

		

		<!-- <![endif]-->

		<!--[if IE]>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<![endif]-->

		<!--[if !IE]> -->

		<script type="text/javascript">
			window.jQuery || document.write("<script src='assets2/js/jquery-2.0.3.min.js'>"+"<"+"/script>");
		</script>

		<!-- <![endif]-->

		<!--[if IE]>
<script type="text/javascript">
 window.jQuery || document.write("<script src='assets2/js/jquery-1.10.2.min.js'>"+"<"+"/script>");
</script>
<![endif]-->

		<script type="text/javascript">
			if("ontouchend" in document) document.write("<script src='assets2/js/jquery.mobile.custom.min.js'>"+"<"+"/script>");
		</script>
		<script src="assets2/js/bootstrap.min.js"></script>
		<script src="assets2/js/typeahead-bs2.min.js"></script>

		<!-- page specific plugin scripts -->

		<!--[if lte IE 8]>
		  <script src="assets2/js/excanvas.min.js"></script>
		<![endif]-->

		<script src="assets2/js/jquery-ui-1.10.3.custom.min.js"></script>
		<script src="assets2/js/jquery.ui.touch-punch.min.js"></script>
		<script src="assets2/js/jquery.gritter.min.js"></script>
		<script src="assets2/js/bootbox.min.js"></script>
		<script src="assets2/js/jquery.slimscroll.min.js"></script>
		<script src="assets2/js/jquery.easy-pie-chart.min.js"></script>
		<script src="assets2/js/jquery.hotkeys.min.js"></script>
		<script src="assets2/js/bootstrap-wysiwyg.min.js"></script>
		<script src="assets2/js/select2.min.js"></script>
		<script src="assets2/js/date-time/bootstrap-datepicker.min.js"></script>
		<script src="assets2/js/fuelux/fuelux.spinner.min.js"></script>
		<script src="assets2/js/x-editable/bootstrap-editable.min.js"></script>
		<script src="assets2/js/x-editable/ace-editable.min.js"></script>
		<script src="assets2/js/jquery.maskedinput.min.js"></script>

		<!-- ace scripts -->

		<script src="assets2/js/ace-elements.min.js"></script>
		<script src="assets2/js/ace.min.js"></script>

		<!-- inline scripts related to this page -->

		<script type="text/javascript">
		
		var uidGlobal;
		
		function dynamicProfile2()
		{
			$.ajax({
				url:"usert/dynamicProfile2.action",
				method:"GET",
				data:{
					"uid": uidGlobal,
				},
				success:function(data)
				{
					
					document.getElementById("numberOfHold").innerText=data.numberOfHold;
					document.getElementById("numberOfSubscribe").innerText=data.numberOfConcern;
					document.getElementById("numberOfHold1").innerText=data.numberOfHold;
				},
				error:function(){
			    	alert("读取数据error2");
			    	
			    },
			})
		}
		 function dynamicProfile(){
			  $.ajax({
					url:"usert/dynamicProfile.action",
					method:"GET",
					
					data:{
				    	"uid": uidGlobal,
				    },
				    success:function(data){
				    	
				    	document.getElementById("userId").innerText=data.uid;
				    	document.getElementById("userName").innerText=data.uname;
				    	if(data.ubirthdate!== null)
				    		{
				    		document.getElementById("birthday").innerText=data.ubirthdate;
				    		}
				    	if(data.uasset!=null)
				    		{
				    		document.getElementById("asset").innerText=data.uasset.toFixed(2) + "元";
				    		document.getElementById("totalAssets").innerText=data.uasset.toFixed(2);
				    		}
				    	if(data.ue_mail!=null)
			    		{
			    		document.getElementById("email").innerText=data.ue_mail;
			    		}
				    	if(data.uqq!=null)
			    		{
			    		document.getElementById("qq").innerText=data.uqq;
			    		}
				    	if(data.uwechat!=null)
			    		{
			    		document.getElementById("wechat").innerText=data.uwechat;
			    		}
				    	if(data.usex =="male")
				    	{
				    	document.getElementById("gender").innerText="男";	
				    	}
				        if(data.usex =="female")
				    	{
				    		document.getElementById("gender").innerText="女";	
				    	}
				    	
				    	if(data.location!=null)
				    	{
				    		document.getElementById("location").innerText=data.location;
				   		}
				    	
				    	
				    },
				    error:function(){
				    	alert("读取数据error");
				    	
				    },
				});
			  
		  }
		 
		 function changeIt()
		 {
			 console.log(uidGlobal);
			   
				var formData = new FormData($("#formFile")[0]);
				console.log(formData);
				$('#formFile').ajaxSubmit({
				    url: "usert/uploadFile.action",    //请求的url地址	
				    type: 'POST',   
				    data:formData,
				    dataType: "text", 
				   	success:function(data) {	
				   		
				   		if(data.indexOf("success")!=-1){
				   			alert("更改成功");				   			
				   			
				   		}else{
				   			alert("更改失败");
				   		}
				   		location.href = "http://localhost:8088/ssf/profile.html";
				    },		   
				    error:function() {
				        //请求出错处理
				        alert("运行异常l");
				    }
				});	
		 }
		 
		 $("#userImg").click(function(){
			 $("#chooseFile").click();
		 })
		 
		 $("#logOut").click(function(){
			 $.ajax({
	    	url:"usert/removeSession.action",
		    method: "GET",
		    success:function(data){
			     if(data== 1)
			    	 {
			    	  console.log("清除session成功");
			    	 }
			     alert("登出成功");
			     location.href = "http://localhost:8088/ssf/index.html";
			     
		    },
		    error:function(){
		    	
		    	console.log("清除session失败");
			
		    }
	    });
		 })
			 
		 var imgSource;
		 
		   $(document).ready(function(){
			   
			   
			   
			   
			   
			   $.ajax({
			    	url:"usert/getSession.action",
				    method: "GET",
				    
				    success:function(data){
					     if(data.uid!= null) {
					    	 uidGlobal = data.uid;
					    	 //alert(uidGlobal);
					    	 dynamicProfile();
					    	 dynamicProfile2();
					    	 imgSource = data.img;
					    	 $("#userImg").attr("src",imgSource);
					    	 //console.log(imgSource);
					    	 $('#dynamic-table1').bootstrapTable('destroy');
							 $('#dynamic-table1').bootstrapTable({
									url : 'usert/searchMySubscribe.action', //请求后台的URL（*）
									method : 'get', //请求方式（*）					
									queryParams : { //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的		
										uid:uidGlobal
									}
							 });
								
								$('#dynamic-table2').bootstrapTable('destroy');
								$('#dynamic-table2').bootstrapTable({
									url : 'usert/selectHoldshareByUid.action', //请求后台的URL（*）
									method : 'get', //请求方式（*）					
									queryParams : { //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的		
										uid:uidGlobal
									}
								});
								
					    	 }
					     else{
					    	 alert("请登录");
					    	 location.href = "http://localhost:8088/ssf/index.html";
					     }
					     
						  
				    },
				    error:function(){
				    	
					     alert("error!");
					
				    }  
			    });
			  //动态个人界面
			  
			 
			   
			   
			   
		   })
		   
		   $("#goBack").click(function(){
			   
			location.href = "http://localhost:8088/ssf/index.html";
		
		   });
			jQuery(function($) {
				
				
			
				
					
			
				$(document).on('click','#add-without-image1',function(){
					 //alert(345);
					 //获取动态title属性的值
					 var uid=$(this).attr("title");
					// alert("uid : "+uid);	 
			location.href="http://localhost:8088/ssf/wines.html?uid="+uid;
				});
				
				var uidGlobal;
				$(document).on('click','#add-without-image2',function(){
					
					 var uid=$(this).attr("title");
					 
					 $.ajax({
					    	url:"usert/getSession.action",
						    method: "GET",
						    async:false,
						    success:function(data){
							     if(data.uid!= null)
							    	 {
							    	 uidGlobal = data.uid;
							    	 
							    	 $.ajax({
							    		 url:"usert/removeSubscribe.action",
							    		 method: "POST",
							    		 
							    		 data : { 		
												uid:uidGlobal,
												sid:uid,
											},
							    		 
							    		 success:function(){
							    			 alert("取消关注成功");
							    			 window.location.reload();s
							    			 
							    		 },
							    		 
							    		 error:function(){
							    			 console.log(uidGlobal + " " + uid);	
										     alert("取消关注error");
										
									    }
							    	 });
							    	 
							    	 }
							     
								  
						    },
						    error:function(){
						    	
							     alert("error2!");
							
						    }
					    });		 
				});
			
				
				
			});
		</script>
		
		<script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.scrollTo.min.js"></script>
    <script src="js/jquery.nicescroll.js" type="text/javascript"></script>

    <!--common script for all pages-->
    <script src="js/jquery.form.js" type="text/javascript"></script>
    
	<script src="js/jquery-ui-1.9.2.custom.min.js"></script>
	<script src="js/jquery-migrate-1.2.1.min.js"></script>
	<script src="js/modernizr.min.js"></script>
	<script src="js/jquery.nicescroll.js"></script>
    <script src="js/bootstrap-table.js"></script>  
	<script src="js/bootstrap-table-export.js"></script>
	<script src="js/bootstrap-table-zh-CN.js"></script>
	<script src="js/tableExport.js"></script>

	<!--dynamic table-->
	<script type="text/javascript" src="js/advanced-datatable/js/jquery.dataTables.js"></script>
	<script type="text/javascript" src="js/data-tables/DT_bootstrap.js"></script>
	<!--dynamic table initialization -->
	<script src="js/dynamic_table_init.js"></script>
		
	</body>
</html>
